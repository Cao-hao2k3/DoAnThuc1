@inject Microsoft.AspNetCore.Http.IHttpContextAccessor _httpContextAccessor;
@{
    var user = _httpContextAccessor.HttpContext.User;
}

@inject ThanTai.Models.ThanTaiShopDbContext _context

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - ThanTai</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/ThanTai.styles.css" asp-append-version="true" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

</head>
<body>

    <!-- Nền vàng + Logo -->
    <div class="navbar-custom d-flex align-items-center px-4">
        <a class="navbar-logo" href="#">
            <img src="~/img/logo.png" alt="Logo">
        </a>

        <div class="info-bar">
            <span>Trạm dừng nghỉ Thần Tài -</span>
            <i class="bi bi-envelope-fill"></i>
            <span class="email">thantaiviet@gmail.com</span>
            <i class="bi bi-phone-fill"></i>
            <span class="phone">02963 836 999</span>
        </div>
    </div>

    <!-- Thanh điều hướng phía dưới -->
    <nav class="navbar navbar-expand-lg navbar-dark-bg nav-bar-section px-4 py-2">
        <div class="container-fluid navbar__footer-inner">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" asp-area="" asp-controller="Home" asp-action="Index">TRANG CHỦ</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white custom-dropdown" asp-area="" asp-controller="Home" asp-action="Index">
                            SẢN PHẨM
                        </a>
                        <ul class="dropdown-menu bg-black">
                            @foreach (var loai in _context.LoaiSanPham.ToList())
                            {
                                <li><a class="dropdown-item text-white dropdown-item-custom" href="#">@loai.Tenloai</a></li>
                            }
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" asp-area="" asp-controller="Home" asp-action="Index">TIN TỨC</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" asp-area="" asp-controller="Home" asp-action="Index">LIÊN HỆ</a>
                    </li>
                </ul>

                <!-- Looking for -->
                <div class="search-box">
                    <i class="bi bi-search"></i>
                    <input type="text" placeholder="Tìm kiếm khóa học, bài viết, video, ...">
                </div>

                <!-- Icons -->
                <div class="d-flex">
                    <!-- Icon Giỏ Hàng với Dropdown -->
                    <div class="icon-btn icon-cart" id="cart-icon">
                        <i class="bi bi-cart"></i>
                        <span class="cart-badge">0</span>

                        <!-- Dropdown Giỏ Hàng -->
                        <div class="dropdown-cart">
                            <div class="cart-header">
                                <span class="cart-quantity">0 Sản phẩm,</span>
                                <span class="cart-total">0VNĐ</span>
                            </div>
                         <div class="cart-footer">
                                <button class="checkout-btn">
                                    <i class="bi bi-check-lg"></i> THANH TOÁN
                                </button>
                         </div>
                        </div>
                    </div>

                   
                </div>
                @if (!user.Identity.IsAuthenticated)
                {
                    <div class="icon-btn icon-menu" id="menu-icon">
                        <i class="bi bi-list"></i>

                        <!-- Dropdown Menu -->
                        <div class="dropdown-menu-custom">
                            <a asp-area="" asp-controller="Home" asp-action="Login" class="dropdown-item d-flex align-items-center">
                                <i class="fas fa-sign-in-alt me-2 text-primary"></i> <span class="fw-bold text-uppercase">Đăng Nhập</span>
                            </a>
                            <hr class="dropdown-divider">
                            <a asp-area="" asp-controller="Home" asp-action="Index" class="dropdown-item d-flex align-items-center">
                                <i class="fas fa-credit-card me-2 text-success"></i> <span class="fw-bold text-uppercase">Thanh Toán</span>
                            </a>
                        </div>
                    </div>
                }
                else
                {
                    // Kiểm tra nếu là Admin thì chỉ hiển thị menu Admin
                    bool isAdmin = _httpContextAccessor.HttpContext.User.IsInRole("Admin");

                    <div class="icon-btn icon-menu" id="menu-icon">
                        <i class="bi bi-list"></i>

                        <!-- Dropdown Menu -->
                        <div class="dropdown-menu-custom">
                            <div class="dropdown-header">
                                <i class="fa-solid fa-user-circle"></i>
                                <span>@user.Claims.FirstOrDefault(c => c.Type == "HoVaTen")?.Value</span>
                            </div>

                            @if (isAdmin)
                            {
                                <a class="dropdown-item" asp-area="Admin" asp-controller="SanPham" asp-action="Index">
                                    <i class="fa-solid fa-chart-line"></i> Quản lý hệ thống
                                </a>
                                <a class="dropdown-item" asp-area="Admin" asp-controller="LoaiSanPham" asp-action="Index">
                                    <i class="fa-solid fa-users-cog"></i> Quản lý người dùng
                                </a>
                                <a class="dropdown-item" asp-area="Admin" asp-controller="Home" asp-action="Index">
                                    <i class="fa-solid fa-boxes"></i> Quản lý đơn hàng
                                </a>
                            }
                            else
                            {
                                <a class="dropdown-item" asp-area="" asp-controller="User" asp-action="Profile">
                                    <i class="fa-solid fa-id-card"></i> Thông tin cá nhân
                                </a>
                                <a class="dropdown-item" asp-area="" asp-controller="Order" asp-action="History">
                                    <i class="fa-solid fa-clock-rotate-left"></i> Lịch sử mua hàng
                                </a>
                                <a class="dropdown-item" asp-area="" asp-controller="Order" asp-action="Index">
                                    <i class="fa-solid fa-box"></i> Xem đơn hàng
                                </a>
                            }

                            <hr class="dropdown-divider">
                            <a class="dropdown-item logout-btn" asp-area="" asp-controller="Home" asp-action="Logout">
                                <i class="fa-solid fa-sign-out-alt"></i> Đăng xuất
                            </a>
                        </div>
                    </div>
                }
            </div>
        </div>
    </nav>

        
        <main role="main" class="pb-3">
            @RenderBody()
        </main>

    <footer class="footer-custom py-5 text-white">
        <div class="container">
            <div class="row">
                <!-- ABOUT US -->
                <div class="col-md-3">
                    <h5 class="fw-bold">ABOUT US</h5>
                    <p>Trạm dừng chân thần tài</p>
                    <p><i class="bi bi-geo-alt-fill text-danger"></i> 679 QL91 - xã Bình Hòa, huyện Châu Thành, tỉnh An Giang.</p>
                    <p><i class="bi bi-telephone-fill text-danger"></i> 02963 836 999 - 0918 082 264</p>
                    <p><i class="bi bi-envelope-fill text-danger"></i> thantaiviet@gmail.com    </p>
                </div>

                <!-- CATEGORIES -->
                <div class="col-md-3">
                    <h5 class="fw-bold">SẢN PHẨM</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="footer-link">Điện tử</a></li>
                        <li><a href="#" class="footer-link">Tủ lạnh</a></li>
                        <li><a href="#" class="footer-link">Máy lọc nước</a></li>

                    </ul>
                </div>

                <!-- INFORMATION -->
                <div class="col-md-3">
                    <h5 class="fw-bold">THÔNG TIN</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="footer-link">Facebook</a></li>
                        <li><a href="#" class="footer-link">Instargram</a></li>
                    </ul>
                </div>

                <!-- SERVICE -->
                <div class="col-md-3">
                    <h5 class="fw-bold">SERVICE</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="footer-link">My Account</a></li>
                        <li><a href="#" class="footer-link">View Cart</a></li>
                        <li><a href="#" class="footer-link">Wishlist</a></li>
                        <li><a href="#" class="footer-link">Track My Order</a></li>
                        <li><a href="#" class="footer-link">Help</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
