@inject Microsoft.AspNetCore.Http.IHttpContextAccessor _httpContextAccessor;
@{
    var user = _httpContextAccessor.HttpContext.User;
    bool isAuthenticated = user.Identity.IsAuthenticated;
    bool isAdmin = user.IsInRole("Admin");
}

@inject ThanTai.Models.ThanTaiShopDbContext _context

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - ThanTai</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/ThanTai.styles.css" asp-append-version="true" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

</head>
<body>

    <!-- Nền vàng + Logo -->
    <div class="navbar-custom d-flex align-items-center px-4">
        <a class="navbar-logo" href="#">
            <img src="~/img/logo.png" alt="Logo">
        </a>

        <div class="info-bar">
            <span>Trạm dừng nghỉ Thần Tài -</span>
            <i class="bi bi-envelope-fill"></i>
            <span class="email">thantaiviet@gmail.com</span>
            <i class="bi bi-phone-fill"></i>
            <span class="phone">02963 836 999</span>
        </div>
    </div>

    <!-- Thanh điều hướng phía dưới -->
    <nav class="navbar navbar-expand-lg navbar-dark-bg nav-bar-section px-4 py-2">
        <div class="container-fluid navbar__footer-inner">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Menu trái -->
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" asp-area="" asp-controller="Home" asp-action="Index">TRANG CHỦ</a>
                    </li>
                    <li class="nav-item dropdown position-static">
                        <a class="nav-link dropdown-toggle text-white custom-dropdown" asp-area="" asp-controller="SanPham" asp-action="Index" id="sanPhamDropdown" role="button">
                            SẢN PHẨM
                        </a>

                        <!-- Danh sách danh mục sản phẩm -->
                        <div style="margin-top: -5px; margin-left: 115px;" class="dropdown-menu mega-menu" aria-labelledby="sanPhamDropdown">
                            <div class="row">
                                <div class="col-3 category-list">
                                    <ul>
                                        <li class="category-item active" data-category="dien-tu">Điện tử, điện máy</li>
                                        <li class="category-item" data-category="gia-dung">Điện gia dụng</li>
                                    </ul>
                                </div>
                                <div class="col-9 product-list">
                                    <div class="category-content dien-tu active">
                                        <div class="row">
                                            <div class="col-3">
                                                <a asp-area="" asp-controller="SanPham" asp-action="MayLanhView">
                                                    <img src="https://cdnv2.tgdd.vn/mwg-static/dmx/Common/82/ab/82ab6158a6b5e938c11e9ebf1d05aae3.png" alt="Máy lạnh">
                                                    <p>Máy lạnh</p>
                                                </a>
                                            </div>

                                            <div class="col-3">
                                                <a asp-area="" asp-controller="SanPham" asp-action="TuLanhView">
                                                    <img src="https://cdnv2.tgdd.vn/mwg-static/dmx/Common/fe/04/fe04b1635dc68b0ec71d9982b1dc8960.png" alt="Tủ lạnh">
                                                    <p>Tủ lạnh</p>
                                                </a>
                                            </div>

                                            <div class="col-3">
                                                <a asp-area="" asp-controller="SanPham" asp-action="TiviView">
                                                    <img src="https://cdnv2.tgdd.vn/mwg-static/dmx/Common/b2/94/b29491c0fa65ea5a6c08856cc17b15a0.png" alt="Tivi">
                                                    <p>Tivi</p>
                                                </a>
                                            </div>

                                            <div class="col-3">
                                                <a asp-area="" asp-controller="SanPham" asp-action="MayGiatView">
                                                    <img src="https://cdnv2.tgdd.vn/mwg-static/dmx/Common/36/c9/36c96df469724206fb6f36b4fc519e65.png" alt="Máy giặt">
                                                    <p>Máy giặt</p>
                                                </a>
                                            </div>
                                        </div>
                                    </div> <!-- ✅ Đóng đúng thẻ <div> -->

                                    <div class="category-content gia-dung">
                                        <div class="row">
                                            <div class="col-3">
                                                <a asp-area="" asp-controller="SanPham" asp-action="MayLocKhongKhiView">
                                                    <img src="https://cdnv2.tgdd.vn/mwg-static/dmx/Common/86/b7/86b7d200bdd564e597ca6ab06204d83f.png" alt="Máy lọc không khí">
                                                    <p>Máy lọc không khí</p>
                                                </a>
                                            </div>

                                            <div class="col-3">
                                                <a asp-area="" asp-controller="SanPham" asp-action="QuatMayView">
                                                    <img src="https://cdnv2.tgdd.vn/mwg-static/dmx/Common/43/03/430374ebb8aa83838d66a5e6733d3697.png" alt="Quạt máy">
                                                    <p>Quạt máy</p>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" asp-area="" asp-controller="BanTin" asp-action="Index">TIN TỨC</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" asp-area="" asp-controller="LienHe" asp-action="Index">LIÊN HỆ</a>
                    </li>
                </ul>

                <!-- Ô tìm kiếm -->
                <div class="search-box">
                    <i class="bi bi-search"></i>
                    <input type="text" placeholder="Tìm kiếm sản phẩm, bài viết...">
                </div>

                <!-- Biểu tượng và dropdown -->
                <div class="d-flex align-items-center">
                    <!-- Giỏ hàng -->
                    <div class="icon-btn icon-cart" id="cart-icon">
                        <i class="bi bi-cart"></i>
                        <span class="cart-badge">0</span>

                        <!-- Dropdown Giỏ Hàng -->
                        <div class="dropdown-cart">
                            <div class="cart-header">
                                <span class="cart-quantity">0 Sản phẩm,</span>
                                <span class="cart-total">0 VNĐ</span>
                            </div>
                            <div class="cart-footer">
                                @if (!isAuthenticated)
                                {
                                    <a asp-area="" asp-controller="Home" asp-action="Login" class="checkout-btn">
                                        <i class="bi bi-check-lg"></i> THANH TOÁN
                                    </a>
                                }
                                else
                                {
                                    <a asp-area="" asp-controller="GioHang" asp-action="Index" class="checkout-btn">
                                        <i class="bi bi-check-lg"></i> THANH TOÁN
                                    </a>
                                }
                            </div>
                        </div>
                    </div>

                    <!-- Tài khoản người dùng -->
                    <div class="icon-btn icon-menu" id="menu-icon">
                        <i class="bi bi-list"></i>

                        <!-- Dropdown Menu -->
                        <div class="dropdown-menu-custom">
                            @if (!isAuthenticated)
                            {
                                <a asp-area="" asp-controller="Home" asp-action="Login" class="dropdown-item d-flex align-items-center">
                                    <i class="fas fa-sign-in-alt me-2 text-primary"></i> <span class="fw-bold text-uppercase">Đăng Nhập</span>
                                </a>
                            }
                            else
                            {
                                <div class="dropdown-header">
                                    <i class="fa-solid fa-user-circle"></i>
                                    <span>@user.Claims.FirstOrDefault(c => c.Type == "HoVaTen")?.Value</span>
                                </div>

                                @if (isAdmin)
                                {
                                    <a class="dropdown-item" asp-area="Admin" asp-controller="SanPham" asp-action="Index">
                                        <i class="fa-solid fa-chart-line"></i> Quản lý hệ thống
                                    </a>
                                    <a class="dropdown-item" asp-area="Admin" asp-controller="LoaiSanPham" asp-action="Index">
                                        <i class="fa-solid fa-users-cog"></i> Quản lý người dùng
                                    </a>
                                    <a class="dropdown-item" asp-area="Admin" asp-controller="DonHang" asp-action="Index">
                                        <i class="fa-solid fa-boxes"></i> Quản lý đơn hàng
                                    </a>
                                }
                                else
                                {
                                    <a class="dropdown-item" asp-area="" asp-controller="ThongTinTaiKhoan" asp-action="Index">
                                        <i class="fa-solid fa-id-card"></i> Thông tin cá nhân
                                    </a>
                                    <a class="dropdown-item" asp-area="" asp-controller="LichSuMuaHang" asp-action="Index">
                                        <i class="fa-solid fa-clock-rotate-left"></i> Lịch sử mua hàng
                                    </a>
                                    <a class="dropdown-item" asp-area="" asp-controller="GioHang" asp-action="Index">
                                        <i class="fa-solid fa-box"></i> Xem đơn hàng
                                    </a>
                                }

                                <hr class="dropdown-divider">
                                <a class="dropdown-item logout-btn" asp-area="" asp-controller="Home" asp-action="Logout">
                                    <i class="fa-solid fa-sign-out-alt"></i> Đăng xuất
                                </a>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

        
        <main role="main" class="pb-3">
            @RenderBody()
        </main>

    <footer class="footer-custom py-5 text-white">
        <div class="container">
            <div class="row">
                <!-- ABOUT US -->
                <div class="col-md-3">
                    <h5 class="fw-bold">ABOUT US</h5>
                    <p>Trạm dừng chân thần tài</p>
                    <p><i class="bi bi-geo-alt-fill text-danger"></i> 679 QL91 - xã Bình Hòa, huyện Châu Thành, tỉnh An Giang.</p>
                    <p><i class="bi bi-telephone-fill text-danger"></i> 02963 836 999 - 0918 082 264</p>
                    <p><i class="bi bi-envelope-fill text-danger"></i> thantaiviet@gmail.com    </p>
                </div>

                <!-- CATEGORIES -->
                <div class="col-md-3">
                    <h5 class="fw-bold">SẢN PHẨM</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="footer-link">Điện tử</a></li>
                        <li><a href="#" class="footer-link">Tủ lạnh</a></li>
                        <li><a href="#" class="footer-link">Máy lọc nước</a></li>

                    </ul>
                </div>

                <!-- INFORMATION -->
                <div class="col-md-3">
                    <h5 class="fw-bold">THÔNG TIN</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="footer-link">Facebook</a></li>
                        <li><a href="#" class="footer-link">Instargram</a></li>
                    </ul>
                </div>

                <!-- SERVICE -->
                <div class="col-md-3">
                    <h5 class="fw-bold">SERVICE</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="footer-link">My Account</a></li>
                        <li><a href="#" class="footer-link">View Cart</a></li>
                        <li><a href="#" class="footer-link">Wishlist</a></li>
                        <li><a href="#" class="footer-link">Track My Order</a></li>
                        <li><a href="#" class="footer-link">Help</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
